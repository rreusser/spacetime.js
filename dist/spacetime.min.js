window.ComplexRootFinder=window.ComplexRootFinder||{},window.Spacetime=window.Spacetime||{},window.Spacetime.Complex=function(a,b){"use strict";b.cosh=b.cosh||function(a){return.5*(b.exp(a)+b.exp(-a))},b.sinh=b.sinh||function(a){return.5*(b.exp(a)-b.exp(-a))},b.tanh=b.tanh||function(a){var c=b.exp(2*a);return(c-1)/(c+1)};var c=function(a,b){this.real=a,this.imag=b};return c.rect=function(a,b){return new c(a,b)},c.fromArray=function(a){return new c(a[0],a[1])},c.polar=function(a,d){return new c(a*b.cos(d),a*b.sin(d))},c.real=function(a){return new c(a,0)},c.imag=function(a){return new c(0,a)},c.prototype.toString=function(){return"("+this.real+(this.imag>=0?"+":"")+this.imag+"i)"},c.create=function(){switch(arguments.length){case 0:return new c(0,0);case 1:if("number"==typeof arguments[0])return new c(arguments[0],0);if(arguments[0]instanceof c)return arguments[0].copy();if(arguments[0]instanceof Array)return new c(arguments[0][0]||0,arguments[0][1]||0);break;case 2:if("number"==typeof arguments[0]&&"number"==typeof arguments[1])return new c(arguments[0],arguments[1])}},c.prototype.copy=function(){return new c(this.real,this.imag)},Object.defineProperties(c.prototype,{mod:{get:function(){return b.sqrt(this.real*this.real+this.imag*this.imag)}},mod2:{get:function(){return this.real*this.real+this.imag*this.imag}},arg:{get:function(){return b.atan2(this.imag,this.real)}},conj:{get:function(){return new c(this.real,-this.imag)}},neg:{get:function(){return new c(-this.real,-this.imag)}},inv:{get:function(){var a=this.real*this.real+this.imag*this.imag;return new c(this.real/a,-this.imag/a)}}}),c.add=function(a,b){return new c(a.real+b.real,a.imag+b.imag)},c.sub=function(a,b){return new c(a.real-b.real,a.imag-b.imag)},c.mul=function(a,b){return new c(a.real*b.real-a.imag*b.imag,a.imag*b.real+a.real*b.imag)},c.fmul=function(a,b){return new c(b*a.real,b*a.imag)},c.div=function(a,b){var d=b.real*b.real+b.imag*b.imag;return new c((a.real*b.real+a.imag*b.imag)/d,(a.imag*b.real-a.real*b.imag)/d)},c.prototype.add=function(a){return this.real+=a.real,this.imag+=a.imag,this},c.prototype.sub=function(a){return this.real-=a.real,this.imag-=a.imag,this},c.prototype.mul=function(a){var b=this.real;return this.real=this.real*a.real-this.imag*a.imag,this.imag=this.imag*a.real+b*a.imag,this},c.prototype.fmul=function(a){return this.real*=a,this.imag*=a,this},c.prototype.div=function(a){var b=this.real,c=a.real*a.real+a.imag*a.imag;return this.real=(this.real*a.real+this.imag*a.imag)/c,this.imag=(this.imag*a.real-b*a.imag)/c,this},c.sqrt=function(a){return c.polar(b.sqrt(a.mod),.5*a.arg)},c.nthRoot=function(a,d){return c.polar(b.pow(a.mod,1/d),a.arg/d)},c.exp=function(a){return c.polar(b.exp(a.real),a.imag)},c.log=function(a){var d=(a.arg+2*b.PI)%(2*b.PI);return new c(b.log(a.mod),d)},c.rpow=function(a,d){return c.polar(b.pow(a.mod,d),a.arg*d)},c.cpow=function(a,d){var e=a.mod2,f=a.arg,g=b.pow(e,.5*d.real)*b.exp(-d.imag*f),h=d.real*f+.5*d.imag*b.log(e);return new c(g*b.cos(h),g*b.sin(h))},c.cos=function(a){return new c(b.cos(a.real)*b.cosh(a.imag),-b.sin(a.real)*b.sinh(a.imag))},c.sin=function(a){return new c(b.sin(a.real)*b.cosh(a.imag),b.cos(a.real)*b.sinh(a.imag))},c.tan=function(a){var d=b.cos(a.real),e=b.sinh(a.imag),f=d*d+e*e;return new c(b.sin(a.real)*d/f,e*b.cosh(a.imag)/f)},c.sec=function(a){return c.cos(a).inv},c.cosec=function(a){return c.sin(a).inv},c.cotan=function(a){return c.tan(a).inv},c.csc=c.cosec,c.cot=c.cotan,c.cosh=function(a){return c.fmul(c.add(c.exp(a),c.exp(a.neg)),.5)},c.sinh=function(a){return c.fmul(c.sub(c.exp(a),c.exp(a.neg)),.5)},c.tanh=function(a){var b=c.exp(a),d=c.exp(a.neg);return c.div(c.sub(b,d),c.add(b,d))},c.cotanh=function(a){var b=c.exp(a),d=c.exp(a.neg);return c.div(c.add(b,d),c.sub(b,d))},c.sech=function(a){return c.cosh(a).inv},c.cosech=function(a){return c.sinh(a).inv},c.csch=c.cosech,c.coth=c.cotanh,Object.defineProperties(c,{I:{get:function(){return new c(0,1)}},J:{get:function(){return new c(0,1)}},ONE:{get:function(){return new c(1,0)}},ZERO:{get:function(){return new c(0,0)}},PI:{get:function(){return new c(b.PI,0)}},E:{get:function(){return new c(b.E,0)}}}),c}(window.Spacetime,Math),window.Spacetime=window.Spacetime||{},window.Spacetime.Linalg=window.Spacetime.Linalg||{},function(a,b){"use strict";var c=function(b,c){var d={type:a.Core.floatingPointArrayType},e=a.Utils.extend({},d,c);this.type=e.type,this.data=new e.type(b)};c.prototype.toString=function(){for(var b="[",c=this.length,d=0;c>d;d++)b+=new a.Complex(this.data[2*d],this.data[2*d+1]),c-1>d&&(b+=", ");return b+="]"},Object.defineProperties(c.prototype,{length:{get:function(){return this.data.length}},norm:{get:function(){for(var a=0,c=this.data.length-1;c>=0;c--)a+=this.data[c]*this.data[c];return b.sqrt(a)}},squaredNorm:{get:function(){for(var a=0,b=this.data.length-1;b>=0;b--)a+=this.data[b]*this.data[b];return a}}}),c.prototype.add=function(a){var b=a.length;if(this.length!==b)throw new TypeError("CVector length mismatch");for(var c=this.length-1;c>=0;c--)this.data[c]+=a.data[c];return this},c.prototype.sub=function(a){var b=a.length;if(this.length!==b)throw new TypeError("CVector length mismatch");for(var c=this.length-1;c>=0;c--)this.data[c]-=a.data[c];return this},c.prototype.mul=function(a){var b=a.length;if(this.length!==b)throw new TypeError("CVector length mismatch");for(var c=this.length-1;c>=0;c--)this.data[c]*=a.data[c];return this},c.prototype.div=function(a){var b=a.length;if(this.length!==b)throw new TypeError("CVector length mismatch");for(var c=this.length-1;c>=0;c--)this.data[c]/=a.data[c];return this},c.add=function(a,b){var d=a.length,e=b.length;if(d!==e)throw new TypeError("CVector length mismatch");for(var f=new c(a.data),g=d-1;g>=0;g--)f.data[g]+=b.data[g];return f},c.sub=function(a,b){var d=a.length,e=b.length;if(d!==e)throw new TypeError("CVector length mismatch");for(var f=new c(a.data),g=d-1;g>=0;g--)f.data[g]-=b.data[g];return f},c.mul=function(a,b){var d=a.length,e=b.length;if(d!==e)throw new TypeError("CVector length mismatch");for(var f=new c(a.data),g=d-1;g>=0;g--)f.data[g]*=b.data[g];return f},c.div=function(a,b){var d=a.length,e=b.length;if(d!==e)throw new TypeError("CVector length mismatch");for(var f=new c(a.data),g=d-1;g>=0;g--)f.data[g]/=b.data[g];return f},a.Linalg.CVector=c}(window.Spacetime,Math),window.Spacetime=window.Spacetime||{},window.Spacetime.Core=function(){"use strict";var a;try{a=Float64Array}catch(b){a=Float32Array}return{floatingPointArrayType:a}}(window.Spacetime,Math),window.Spacetime=window.Spacetime||{},window.Spacetime.Derivation=function(a){"use strict";var b=function(a,b,c){c=void 0===c?1e-4:c;var d=a(b+c),e=a(b-c);return.5*(d-e)/c},c=function(a,b,c){c=void 0===c?1e-4:c;var d=a(b+c),e=a(b),f=a(b-c);return(d-2*e+f)/c/c},d=function(b,c,d){d=void 0===d?a.Complex.Real(1e-4):d;var e=b(a.Complex.add(c,d)),f=b(a.Complex.sub(c,d));return a.Complex.sub(e,f).fmul(.5).div(d)},e=function(b,c,d){d=void 0===d?a.Complex.Real(1e-4):d;var e=b(a.Complex.add(c,d)),f=b(c),g=b(a.Complex.sub(c,d));return a.Complex.add(e,g).sub(f.fmul(2)).div(d).div(d)};return{deriv:b,deriv2:c,cderiv:d,cderiv2:e}}(window.Spacetime,Math),window.Spacetime=window.Spacetime||{},window.Spacetime.Integration=function(a){"use strict";var b={trapezoidal:function(){var a=this.h,b=0;b+=.5*this.f(this.a,this.data),b+=.5*this.f(this.b,this.data);for(var c=1;c<this.bins;c++)b+=this.f(this.a+c*a,this.data);return b*a},simpson:function(){if(this.bins%2!==0||this.bins<2)throw new RangeError("Simpson Integrator: Invalid number of bins ("+this.bins+"). Bins must be even.");var a=this.h,b=0;b+=this.f(this.a,this.data),b+=this.f(this.b,this.data);for(var c=1;c<this.bins;c++)b+=(c%2===0?2:4)*this.f(this.a+c*a,this.data);return b*a/3}},c=function(c){b[c]=function(){var b=[0],d=function(a,b,c,d){a[0]=this.f(c,d)}.bind(this),e=new a.ODE.Integrator(d,b,{method:c,dt:this.h,t:this.a});return e.steps(this.bins),b[0]}};c("euler"),c("rk2"),c("rk4"),b.midpoint=b.rk2;var d=function(c,d,e,f){this.f=c,this.a=d,this.b=e;var g={bins:100,method:"simpson"};a.Utils.extend(this,g,f),this.integrator=b[this.method].bind(this)};Object.defineProperties(d.prototype,{h:{get:function(){return(this.b-this.a)/this.bins}}}),d.prototype.integrate=function(){return this.integrator(this)};var e=function(a,b,c,e){return new d(a,b,c,e).integrate()};return{Integrator:d,Integrate:e}}(window.Spacetime,Math),window.Spacetime=window.Spacetime||{},window.Spacetime.ODE=function(a){var b=function(a,b){this.count=a;for(var c=0;c<this.count;c++){var d="w"+c;this[d]=new Array(b)}};b.prototype.mixInto=function(a){this.w=this.w||[];for(var b=0;b<this.count;b++){var c="w"+b;a[c]=this[c]}};var c={euler:{workspaceCount:1,stepper:function(){this.f(this.w0,this.y,this.t,this.data);for(var a=0;a<this.n;a++)this.y[a]+=this.w0[a]*this.dt;this.t+=this.dt}},midpoint:{workspaceCount:2,stepper:function(){this.f(this.w0,this.y,this.t,this.data);for(var a=0;a<this.n;a++)this.w1[a]=this.y[a]+.5*this.dt*this.w0[a];for(this.f(this.w0,this.w1,this.t+.5*this.dt,this.data),a=0;a<this.n;a++)this.y[a]+=this.w0[a]*this.dt;this.t+=this.dt}},rk4:{workspaceCount:5,stepper:function(){var a,b=this.n,c=this.t,d=this.y,e=this.f,f=this.dt,g=this.w0,h=this.w1,i=this.w2,j=this.w3,k=this.w4,l=this.data;for(e(h,d,c,l),a=0;b>a;a++)g[a]=d[a]+.5*h[a]*f;for(e(i,g,c+.5*f,l),a=0;b>a;a++)g[a]=d[a]+.5*i[a]*f;for(e(j,g,c+.5*f,l),a=0;b>a;a++)g[a]=d[a]+j[a]*f;for(e(k,g,c+f,l),a=0;b>a;a++)d[a]+=f/3*(.5*(h[a]+k[a])+i[a]+j[a]);this.t+=this.dt}}};c.rk2=c.midpoint;var d=function(d,e,f){this.f=d,this.y=e,this.n=void 0===e?0:e.length;var g={method:"euler",dt:1,t:0};this.options=a.Utils.extend(this,g,f),this.integrator=c[this.method],this.workspace=new b(this.integrator.workspaceCount,this.n),this.workspace.mixInto(this),this.step=this.integrator.stepper.bind(this)};return d.prototype.steps=function(a){for(var b=0;a>b;b++)this.step()},{Integrator:d}}(window.Spacetime,Math),window.Spacetime=window.Spacetime||{},window.Spacetime.PathIntegration=function(a,b){"use strict";var c={method:"rk4",steps:10},d=function(b,d,e){a.Utils.extend(this,c,e),this.y=[0,0],this.odeFunc=function(a,c,e){var f=d.z(e),g=d.dz(e),h=b(f);a[0]=h.real*g.real-h.imag*g.imag,a[1]=h.imag*g.real+h.real*g.imag},this.ode=new a.ODE.Integrator(this.odeFunc,this.y,{method:this.method,t:d.s1,dt:(d.s2-d.s1)/this.steps})};d.prototype.integrate=function(){return this.ode.steps(this.steps),this};var e=function(b,c,e){var f=new d(b,c,e).integrate();return a.Complex.rect(f.y[0],f.y[1])},f=function(b,c,d,e){var f=a.Derivation.cderiv;c=c||function(a){return f(b,b(a))},this.dz=c,this.z=b,this.s1=d,this.s2=e};return f.Circle=function(c,d){var e=a.Complex,g=function(a){return e.polar(d,a).add(c)},h=function(a){return e.polar(d,a+.5*b.PI).fmul(d)};return new f(g,h,0,2*b.PI)},{Integrator:d,Integrate:e,Path:f}}(window.Spacetime,Math,window.Complex),window.Spacetime=window.Spacetime||{},window.Spacetime.Polynomial=function(a,b){"use strict";var c=function(b){for(var c,d=[],e=0;e<b.length;e++)c=b[e],d[e]=null==c||"object"!=typeof c?c:a.Complex.create(c);return d},d=function(){this.a=arguments[0]||[]};return d.prototype.copy=function(){return new d(c(this.a))},d.create=function(){return 1===arguments.length&&arguments[0]instanceof d?arguments[0].copy():new d(1===arguments.length&&arguments[0]instanceof Array?c(arguments[0]):c(Array.apply(this,arguments)))},Object.defineProperties(d.prototype,{order:{get:function(){return this.a.length-1}}}),d.prototype.toString=function(){for(var a="",b=this.order,c=0;b>=c;c++)a+=this.a[c].toString(),c>0&&(a+="z"),c>1&&(a+="^"+c),b>c&&(a+=" + ");return a},d.prototype.evaluate=function(b){for(var c=this.order,d=a.Complex.ONE,e=this.a[0],f=1;c>=f;f++)e.add(a.Complex.mul(d.mul(b),this.a[f]));return e},d.add=function(c,e){var f,g,h=b.max(c.order,e.order),i=new d;for(g=0;h>=g;g++)f=a.Complex.ZERO,void 0!==c.a[g]&&f.add(c.a[g]),void 0!==e.a[g]&&f.add(e.a[g]),i.a[g]=f;return i},d.diff=function(b){var c,e=b.order,f=new d;for(c=1;e>=c;c++)f.a[c-1]=a.Complex.fmul(b.a[c],c);return f},d.prototype.diff=function(){this.a.shift();var a,b=this.order;for(a=1;b>=a;a++)this.a[a].fmul(a+1);return this},d.mul=function(b,c){var e,f,g=b.order,h=c.order,i=g+h,j=new d;for(e=0;i+1>e;e++)j.a[e]=a.Complex.ZERO;for(e=0;g>=e;e++)for(f=0;h>=f;f++)j.a[e+f].add(a.Complex.mul(b.a[e],c.a[f]));return j},d.cmul=function(a,b){for(var c=a.copy(),d=c.order;d>=0;d--)c.a[d].mul(b);return c},{CPoly:d}}(window.Spacetime,Math),window.Spacetime=window.Spacetime||{},window.Spacetime.Utils={extend:function(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[0][b]=arguments[a][b]);return arguments[0]}},window.Spacetime=window.Spacetime||{},window.Spacetime.Linalg=window.Spacetime.Linalg||{},function(a,b){"use strict";var c={type:a.Core.floatingPointArrayType},d=function(b,d){var e=a.Utils.extend({},c,d);this.type=e.type,this.data=new e.type(b)};d.prototype.toString=function(){for(var a="[",b=this.length,c=0;b>c;c++)a+=this.data[c],b-1>c&&(a+=", ");return a+="]"},Object.defineProperties(d.prototype,{length:{get:function(){return this.data.length}},norm:{get:function(){for(var a=0,c=this.data.length-1;c>=0;c--)a+=this.data[c]*this.data[c];return b.sqrt(a)}},squaredNorm:{get:function(){for(var a=0,b=this.data.length-1;b>=0;b--)a+=this.data[b]*this.data[b];return a}}}),d.prototype.add=function(a){var b=a.length;if(this.length!==b)throw new TypeError("RVector length mismatch");for(var c=this.length-1;c>=0;c--)this.data[c]+=a.data[c];return this},d.prototype.sub=function(a){var b=a.length;if(this.length!==b)throw new TypeError("RVector length mismatch");for(var c=this.length-1;c>=0;c--)this.data[c]-=a.data[c];return this},d.prototype.mul=function(a){var b=a.length;if(this.length!==b)throw new TypeError("RVector length mismatch");for(var c=this.length-1;c>=0;c--)this.data[c]*=a.data[c];return this},d.prototype.div=function(a){var b=a.length;if(this.length!==b)throw new TypeError("RVector length mismatch");for(var c=this.length-1;c>=0;c--)this.data[c]/=a.data[c];return this},d.add=function(a,b){var c=a.length,e=b.length;if(c!==e)throw new TypeError("RVector length mismatch");for(var f=new d(a.data),g=c-1;g>=0;g--)f.data[g]+=b.data[g];return f},d.sub=function(a,b){var c=a.length,e=b.length;if(c!==e)throw new TypeError("RVector length mismatch");for(var f=new d(a.data),g=c-1;g>=0;g--)f.data[g]-=b.data[g];return f},d.mul=function(a,b){var c=a.length,e=b.length;if(c!==e)throw new TypeError("RVector length mismatch");for(var f=new d(a.data),g=c-1;g>=0;g--)f.data[g]*=b.data[g];return f},d.div=function(a,b){var c=a.length,e=b.length;if(c!==e)throw new TypeError("RVector length mismatch");for(var f=new d(a.data),g=c-1;g>=0;g--)f.data[g]/=b.data[g];return f},a.Linalg.RVector=d}(window.Spacetime,Math);